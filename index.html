<!DOCTYPE html>
<html>
  <body>
    <div
      style="
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      "
    >
      <h2>Table to CSV converter</h2>
      <table border="1" cellspacing="0" cellpadding="10">
        <tr>
          <th>Name</th>
          <th>age</th>
          <th>place</th>
        </tr>
        <tr>
          <td>Laxman</td>
          <td>19</td>
          <td>Hyderabad</td>
        </tr>
        <tr>
          <td>Dhoni</td>
          <td>22</td>
          <td>Ranchi</td>
        </tr>
        <tr>
          <td>Kohli</td>
          <td>25</td>
          <td>Delhi</td>
        </tr>
      </table>
      <br /><br />
      <button type="button">download CSV</button>
    </div>
    <script>
      const data = Array.from(document.getElementsByTagName("tr"))
        .map((row) =>
          Array.from(row.querySelectorAll("td,th"))
            .map((tdth) => tdth.innerHTML)
            .join(",")
        )
        .join("\n");
      function downloadCSVFile(csv_data) {
        // Create CSV file object and feed our
        // csv_data into it
        CSVFile = new Blob([csv_data], { type: "text/csv" });

        // Create to temporary link to initiate
        // download process
        var temp_link = document.createElement("a");

        // Download csv file
        temp_link.download = "GfG.csv";
        var url = window.URL.createObjectURL(CSVFile);
        temp_link.href = url;

        // This link should not be displayed
        temp_link.style.display = "none";
        document.body.appendChild(temp_link);

        // Automatically click the link to trigger download
        temp_link.click();
        document.body.removeChild(temp_link);
      }
      //   downloadCSVFile(data);
    </script>
  </body>
</html>
